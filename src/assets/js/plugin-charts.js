Ext.onReady(function(){function e(){var p=0;var m=0;var k=0;var j=0;var q=0;var o=0;var l=0;this.addData=function(n,t){if(q==0){o=n;l=t}else{var s=n-o;var r=t-l;k+=s*s*q/(q+1);j+=s*r*q/(q+1);o+=s/(q+1);l+=r/(q+1)}p+=n;m+=t;q++};this.predict=function(n){var r=this.getSlope();return this.getIntercept(r)+r*n};this.getSlope=function(){if(q<2){return Number.NaN}return j/k};this.getIntercept=function(n){return(m-n*p)/q}}Ext.Ajax.method="GET";Ext.isIE=(/trident/.test(Ext.userAgent));Ext.isIE11=Ext.isIE&&(/rv:11.0/.test(Ext.userAgent));Ext.util.CSS.createStyleSheet=function(l,o){var k,j=document.getElementsByTagName("head")[0],n=document.createElement("style");n.setAttribute("type","text/css");if(o){n.setAttribute("id",o)}if(Ext.isIE&&!Ext.isIE11){j.appendChild(n);k=n.styleSheet;k.cssText=l}else{try{n.appendChild(document.createTextNode(l))}catch(m){n.cssText=l}j.appendChild(n);k=n.styleSheet?n.styleSheet:(n.sheet||document.styleSheets[document.styleSheets.length-1])}this.cacheStyleSheet(k);return k};Ext.override(Ext.chart.Chart,{insetPaddingObject:{},alignAxes:function(){var n=this,m=n.axes,q=n.legend,l=["top","right","bottom","left"],r,p=n.insetPadding,o=n.insetPaddingObject,k={top:o.top||p,right:o.right||p,bottom:o.bottom||p,left:o.left||p};function j(t){var s=m.findIndex("position",t);return(s<0)?null:m.getAt(s)}Ext.each(l,function(t){var v=(t==="left"||t==="right"),s=j(t),u;if(q!==false){if(q.position===t){u=q.getBBox();k[t]+=(v?u.width:u.height)+k[t]}}if(s&&s.bbox){u=s.bbox;k[t]+=(v?u.width:u.height)}});r={x:k.left,y:k.top,width:n.curWidth-k.left-k.right,height:n.curHeight-k.top-k.bottom};n.chartBBox=r;m.each(function(s){var u=s.position,t=(u==="left"||u==="right");s.x=(u==="right"?r.x+r.width:r.x);s.y=(u==="top"?r.y:r.y+r.height);s.width=(t?r.width:r.height);s.length=(t?r.height:r.width)})}});Ext.override(Ext.chart.series.Line,{drawSeries:function(){var bz=this,bn=bz.chart,a2=bn.axes,bv=bn.getChartStore(),aZ=bv.getCount(),aC=bz.chart.surface,bx={},a3=bz.group,ba=bz.showMarkers,bL=bz.markerGroup,bm=bn.shadow,bo=bz.shadowGroups,aX=bz.shadowAttributes,a6=bz.smooth,aG=bo.length,bs=["M"],a1=["M"],aR=["M"],aT=["M"],bb=bn.markerIndex,bB=[].concat(bz.axis),bC,bl=[],bD={},bJ=[],y={},bc=false,a4=[],bd=bz.markerStyle,aV=bz.style,aD=bz.colorArrayStyle,a5=aD&&aD.length||0,a9=Ext.isNumber,bj=bz.seriesIdx,aO=bz.getAxesForXAndYFields(),aL=aO.xAxis,bf=aO.yAxis,bH,aN,bI,bG,br,aS,bF,be,bg,aP,aQ,aE,aF,aY,a7,a8,bp,aK,bi,bk,bK,aJ,aH,bq,aU,aW,bE,j,bt,x,bu,aI,bh,bw,by,a0,aM,bA;if(bz.fireEvent("beforedraw",bz)===false){return}if(!aZ||bz.seriesIsHidden){bA=this.items;if(bA){for(a7=0,bp=bA.length;a7<bp;++a7){if(bA[a7].sprite){bA[a7].sprite.hide(true)}}}return}bw=Ext.apply(bd||{},bz.markerConfig);a0=bw.type;delete bw.type;by=aV;if(!by["stroke-width"]){by["stroke-width"]=0.5}if(bb&&bL&&bL.getCount()){for(a7=0;a7<bb;a7++){bk=bL.getAt(a7);bL.remove(bk);bL.add(bk);bK=bL.getAt(bL.getCount()-2);bk.setAttributes({x:0,y:0,translate:{x:bK.attr.translation.x,y:bK.attr.translation.y}},true)}}bz.unHighlightItem();bz.cleanHighlights();bz.setBBox();bx=bz.bbox;bz.clipRect=[bx.x,bx.y,bx.width,bx.height];for(a7=0,bp=bB.length;a7<bp;a7++){aK=a2.get(bB[a7]);if(aK){bi=aK.calcEnds();if(aK.position=="top"||aK.position=="bottom"){j=bi.from;bt=bi.to}else{x=bi.from;bu=bi.to}}}if(bz.xField&&!a9(j)&&(aL=="bottom"||aL=="top")&&!a2.get(aL)){aK=Ext.create("Ext.chart.axis.Axis",{chart:bn,fields:[].concat(bz.xField)}).calcEnds();j=aK.from;bt=aK.to}if(bz.yField&&!a9(x)&&(bf=="right"||bf=="left")&&!a2.get(bf)){aK=Ext.create("Ext.chart.axis.Axis",{chart:bn,fields:[].concat(bz.yField)}).calcEnds();x=aK.from;bu=aK.to}if(isNaN(j)){j=0;aW=bx.width/((aZ-1)||1)}else{aW=bx.width/((bt-j)||(aZ-1)||1)}if(isNaN(x)){x=0;bE=bx.height/((aZ-1)||1)}else{bE=bx.height/((bu-x)||(aZ-1)||1)}bz.eachRecord(function(l,k){aH=l.get(bz.xField);if(typeof aH=="string"||typeof aH=="object"&&!Ext.isDate(aH)||aL&&a2.get(aL)&&a2.get(aL).type=="Category"){if(aH in bD){aH=bD[aH]}else{aH=bD[aH]=k}}bq=l.get(bz.yField);if(typeof bq=="undefined"||(typeof bq=="string"&&!bq)){if(Ext.isDefined(Ext.global.console)){Ext.global.console.warn("[Ext.chart.series.Line]  Skipping a store element with an undefined value at ",l,aH,bq)}return}if(typeof bq=="object"&&!Ext.isDate(bq)||bf&&a2.get(bf)&&a2.get(bf).type=="Category"){bq=k}a4.push(k);bl.push(aH);bJ.push(bq)});bp=bl.length;if(bp>bx.width){aU=bz.shrink(bl,bJ,bx.width);bl=aU.x;bJ=aU.y}bz.items=[];aM=0;bp=bl.length;for(a7=0;a7<bp;a7++){aH=bl[a7];bq=bJ[a7];if(bq===false){if(a1.length==1){a1=[]}bc=true;bz.items.push(false);continue}else{be=(bx.x+(aH-j)*aW).toFixed(2);bg=((bx.y+bx.height)-(bq-x)*bE).toFixed(2);if(bc){bc=false;a1.push("M")}a1=a1.concat([be,bg])}if((typeof aF=="undefined")&&(typeof bg!="undefined")){aF=bg;aE=be}if(!bz.line||bn.resizing){bs=bs.concat([be,bx.y+bx.height/2])}if(bn.animate&&bn.resizing&&bz.line){bz.line.setAttributes({path:bs},true);if(bz.fillPath){bz.fillPath.setAttributes({path:bs,opacity:0.2},true)}if(bz.line.shadows){bH=bz.line.shadows;for(a8=0,aG=bH.length;a8<aG;a8++){aN=bH[a8];aN.setAttributes({path:bs},true)}}}if(ba){bk=bL.getAt(aM++);if(!bk){bk=Ext.chart.Shape[a0](aC,Ext.apply({group:[a3,bL],x:0,y:0,translate:{x:+(aP||be),y:aQ||(bx.y+bx.height/2)},value:'"'+aH+", "+bq+'"',zIndex:4000},bw));bk._to={translate:{x:+be,y:+bg}}}else{bk.setAttributes({value:'"'+aH+", "+bq+'"',x:0,y:0,hidden:false},true);bk._to={translate:{x:+be,y:+bg}}}}bz.items.push({series:bz,value:[aH,bq],point:[be,bg],sprite:bk,storeItem:bv.getAt(a4[a7])});aP=be;aQ=bg}if(a1.length<=1){return}if(bz.smooth){aT=Ext.draw.Draw.smooth(a1,a9(a6)?a6:bz.defaultSmoothness)}aR=a6?aT:a1;if(bn.markerIndex&&bz.previousPath){bG=bz.previousPath;if(!a6){Ext.Array.erase(bG,1,2)}}else{bG=a1}if(!bz.line){bz.line=aC.add(Ext.apply({type:"path",group:a3,path:bs,stroke:by.stroke||by.fill},by||{}));if(bm){bz.line.setAttributes(Ext.apply({},bz.shadowOptions),true)}bz.line.setAttributes({fill:"none",zIndex:3000});if(!by.stroke&&a5){bz.line.setAttributes({stroke:aD[bj%a5]},true)}if(bm){bH=bz.line.shadows=[];for(bI=0;bI<aG;bI++){bC=aX[bI];bC=Ext.apply({},bC,{path:bs});aN=aC.add(Ext.apply({},{type:"path",group:bo[bI]},bC));bH.push(aN)}}}if(bz.fill){aS=aR.concat([["L",be,bx.y+bx.height],["L",aE,bx.y+bx.height],["L",aE,aF]]);if(!bz.fillPath){bz.fillPath=aC.add({group:a3,type:"path",opacity:by.opacity||0.3,fill:by.fill||aD[bj%a5],path:bs})}}aY=ba&&bL.getCount();if(bn.animate){br=bz.fill;aI=bz.line;bF=bz.renderer(aI,false,{path:aR},a7,bv);Ext.apply(bF,by||{},{stroke:by.stroke||by.fill});delete bF.fill;aI.show(true);if(bn.markerIndex&&bz.previousPath){bz.animation=bh=bz.onAnimate(aI,{to:bF,from:{path:bG}})}else{bz.animation=bh=bz.onAnimate(aI,{to:bF})}if(bm){bH=aI.shadows;for(a8=0;a8<aG;a8++){bH[a8].show(true);if(bn.markerIndex&&bz.previousPath){bz.onAnimate(bH[a8],{to:{path:aR},from:{path:bG}})}else{bz.onAnimate(bH[a8],{to:{path:aR}})}}}if(br){bz.fillPath.show(true);bz.onAnimate(bz.fillPath,{to:Ext.apply({},{path:aS,fill:by.fill||aD[bj%a5],"stroke-width":0},by||{})})}if(ba){aM=0;for(a7=0;a7<bp;a7++){if(bz.items[a7]){aJ=bL.getAt(aM++);if(aJ){bF=bz.renderer(aJ,bv.getAt(a7),aJ._to,a7,bv);bz.onAnimate(aJ,{to:Ext.apply(bF,bw||{})});aJ.show(true)}}}for(;aM<aY;aM++){aJ=bL.getAt(aM);aJ.hide(true)}}}else{bF=bz.renderer(bz.line,false,{path:aR,hidden:false},a7,bv);Ext.apply(bF,by||{},{stroke:by.stroke||by.fill});delete bF.fill;bz.line.setAttributes(bF,true);if(bm){bH=bz.line.shadows;for(a8=0;a8<aG;a8++){bH[a8].setAttributes({path:aR,hidden:false},true)}}if(bz.fill){bz.fillPath.setAttributes({path:aS,hidden:false},true)}if(ba){aM=0;for(a7=0;a7<bp;a7++){if(bz.items[a7]){aJ=bL.getAt(aM++);if(aJ){bF=bz.renderer(aJ,bv.getAt(a7),aJ._to,a7,bv);aJ.setAttributes(Ext.apply(bw||{},bF||{}),true);aJ.show(true)}}}for(;aM<aY;aM++){aJ=bL.getAt(aM);aJ.hide(true)}}}if(bn.markerIndex){if(bz.smooth){Ext.Array.erase(a1,1,2)}else{Ext.Array.splice(a1,1,0,a1[1],a1[2])}bz.previousPath=a1}bz.renderLabels();bz.renderCallouts();bz.fireEvent("draw",bz)}});Ext.override(Ext.chart.Legend,{updatePosition:function(){var q=this,t,r,v=q.width,u=q.height,s=q.padding,p=q.chart,w=p.chartBBox,k=p.insetPadding,m=w.width-(k*2),l=w.height-(k*2),o=w.x+k,n=w.y+k,j=p.surface,z=Math.floor;if(q.isDisplayed()){switch(q.position){case"left":t=k;r=z(n+l/2-u/2);break;case"right":t=z(j.width-v)-k;r=z(n+l/2-u/2);break;case"top":t=z((o+w.width)/2-v/2)-7;r=k;break;case"bottom":t=z(o+m/2-v/2);r=z(j.height-u)-k;break;default:t=z(q.origX)+k;r=z(q.origY)+k}q.x=t;q.y=r;Ext.each(q.items,function(x){x.updatePosition()});q.boxSprite.setAttributes(q.getBBox(),true)}}});Ext.override(Ext.chart.LegendItem,{createLegend:function(C){var D=this,q=C.yFieldIndex,t=D.series,j=t.type,u=D.yFieldIndex,m=D.legend,x=D.surface,A=m.x+D.x,v=m.y+D.y,l,s=D.zIndex,k,r,B,n,w=false,p=Ext.apply(t.seriesStyle,t.style),y=m.labelMarkerSize||10;function o(z){var E=t[z];return(Ext.isArray(E)?E[u]:E)}r=D.add("label",x.add({type:"text",x:30,y:0,zIndex:s||0,font:m.labelFont,fill:m.labelColor||"#000",text:o("title")||o("yField")}));if(j==="line"||j==="scatter"){if(j==="line"){D.add("line",x.add({type:"path",path:"M0.5,0.5L16.5,0.5",zIndex:s,"stroke-width":t.lineWidth,"stroke-linejoin":"round","stroke-dasharray":t.dash,stroke:p.stroke||"#000",style:{cursor:"pointer"}}))}if(t.showMarkers||j==="scatter"){k=Ext.apply(t.markerStyle,t.markerConfig||{});D.add("marker",Ext.chart.Shape[k.type](x,{fill:k.fill,x:8.5,y:0.5,zIndex:s,radius:k.radius||k.size,style:{cursor:"pointer"}}))}}else{D.add("box",x.add({type:"rect",zIndex:s,x:6,y:0,width:y,height:y,fill:t.getLegendColor(q),style:{cursor:"pointer"}}))}D.setAttributes({hidden:false},true);l=D.getBBox();B=D.add("mask",x.add({type:"rect",x:l.x,y:l.y,width:l.width||20,height:l.height||20,zIndex:(s||0)+1000,fill:"#f00",opacity:0,style:{cursor:"pointer"}}));D.on("mouseover",function(){r.setStyle({"font-weight":"bold"});B.setStyle({cursor:"pointer"});t._index=q;t.highlightItem()},D);D.on("mouseout",function(){r.setStyle({"font-weight":"normal"});t._index=q;t.unHighlightItem()},D);if(!t.visibleInLegend(q)){w=true;r.setAttributes({opacity:0.5},true)}D.on("mousedown",function(){if(!w){t.hideAll();r.setAttributes({opacity:0.5},true)}else{t.showAll();r.setAttributes({opacity:1},true)}w=!w},D);D.updatePosition({x:0,y:0})}});Ext.override(Ext.chart.axis.Axis,{drawHorizontalLabels:function(){var P=this,l=P.label,J=Math.floor,H=Math.max,I=P.chart.axes,Q=P.position,r=P.inflections,v=r.length,N=P.labels,A=P.labelGroup,B=0,o,L=P.chart.maxGutter[1],m,j,E,n,u,K=0,M,D,q,z,p,t,w,s,G,k;t=v-1;E=r[0];k=P.getOrCreateLabel(0,P.label.renderer(N[0]));o=Math.floor(Math.abs(Math.sin(l.rotate&&(l.rotate.degrees*Math.PI/180)||0)));for(G=0;G<v;G++){E=r[G];z=P.label.renderer(N[G])||"";M=P.getOrCreateLabel(G,z);j=M._bbox;B=H(B,j.height+P.dashSize+P.label.padding);w=J(E[0]-(o?j.height:j.width)/2);if(P.chart.maxGutter[0]==0){if(G==0&&I.findIndex("position","left")==-1){w=E[0]}else{if(G==t&&I.findIndex("position","right")==-1){w=E[0]-j.width}}}if(Q=="top"){s=E[1]-(P.dashSize*2)-P.label.padding-(j.height/2)}else{s=E[1]+(P.dashSize*2)+P.label.padding+(j.height/2)}var C=l.rotate&&l.rotate.degrees&&!Ext.Array.contains([0,90,180,270,360],l.rotate.degrees),F=Math.floor((M.text.length-12)*-1*0.75),O=C?E[0]-M._bbox.width+F:w;M.setAttributes({hidden:false,x:O,y:s},true);if(G!=0&&(P.intersect(M,u)||P.intersect(M,k))){M.hide(true);continue}u=M}return B}});Ext.override(Ext.chart.axis.Radial,{drawLabel:function(){var A=this.chart,G=A.surface,l=A.chartBBox,r=A.store,v=l.x+(l.width/2),u=l.y+(l.height/2),o=Math.min(l.width,l.height)/2,K=Math.max,N=Math.round,B=[],t,E=[],m,F=[],p,C=!this.maximum,M=this.maximum||0,L=this.steps,J=0,I,y,x,D=Math.PI*2,n=Math.cos,k=Math.sin,H=this.label.display,w=H!=="none",z=10,O="#333",s="normal 9px sans-serif",q=A.seriesStyle;O=q?q.labelColor:O;s=q?q.labelFont:s;if(!w){return}A.series.each(function(j){E.push(j.yField);p=j.xField});r.each(function(j,P){if(C){for(P=0,m=E.length;P<m;P++){M=K(+j.get(E[P]),M)}}F.push(j.get(p))});if(!this.labelArray){if(H!="categories"){for(J=1;J<=L;J++){t=G.add({type:"text",text:N(J/L*M),x:v,y:u-o*J/L,"text-anchor":"middle","stroke-width":0.1,stroke:"#333",fill:O,font:s});t.setAttributes({hidden:false},true);B.push(t)}}if(H!="scale"){for(I=0,L=F.length;I<L;I++){y=n(I/L*D)*(o+z);x=k(I/L*D)*(o+z);t=G.add({type:"text",text:F[I],x:v+y,y:u+x,"text-anchor":y*y<=0.001?"middle":(y<0?"end":"start"),fill:O,font:s});t.setAttributes({hidden:false},true);B.push(t)}}}else{B=this.labelArray;if(H!="categories"){for(J=0;J<L;J++){B[J].setAttributes({text:N((J+1)/L*M),x:v,y:u-o*(J+1)/L,"text-anchor":"middle","stroke-width":0.1,stroke:"#333",fill:O,font:s},true)}}if(H!="scale"){for(I=0,L=F.length;I<L;I++){y=n(I/L*D)*(o+z);x=k(I/L*D)*(o+z);if(B[J+I]){B[J+I].setAttributes({type:"text",text:F[I],x:v+y,y:u+x,"text-anchor":y*y<=0.001?"middle":(y<0?"end":"start"),fill:O,font:s},true)}}}}this.labelArray=B}});d={};var d=d;d.instances=[];d.i18n={};d.isDebug=false;d.isSessionStorage=("sessionStorage" in window&&window.sessionStorage!==null);d.getCore=function(r,s){var n={},l={},q={},m={},k={},j={},p,o;s=s||{};p=function(){};j.getViewportWidth=function(){};j.getViewportHeight=function(){};j.getCenterRegionWidth=function(){};j.getCenterRegionHeight=function(){};(function(){n.finals={dimension:{data:{value:"data",name:d.i18n.data||"Data",dimensionName:"dx",objectName:"dx"},category:{name:d.i18n.assigned_categories||"Assigned categories",dimensionName:"co",objectName:"co"},indicator:{value:"indicators",name:d.i18n.indicators||"Indicators",dimensionName:"dx",objectName:"in"},dataElement:{value:"dataElements",name:d.i18n.data_elements||"Data elements",dimensionName:"dx",objectName:"de"},operand:{value:"operand",name:"Operand",dimensionName:"dx",objectName:"dc"},dataSet:{value:"dataSets",name:d.i18n.data_sets||"Data sets",dimensionName:"dx",objectName:"ds"},eventDataItem:{value:"eventDataItem",name:d.i18n.event_data_items||"Event data items",dimensionName:"dx",objectName:"di"},programIndicator:{value:"programIndicator",name:d.i18n.program_indicators||"Program indicators",dimensionName:"dx",objectName:"pi"},period:{value:"period",name:d.i18n.periods||"Periods",dimensionName:"pe",objectName:"pe"},fixedPeriod:{value:"periods"},relativePeriod:{value:"relativePeriods"},organisationUnit:{value:"organisationUnits",name:d.i18n.organisation_units||"Organisation units",dimensionName:"ou",objectName:"ou"},dimension:{value:"dimension"},value:{value:"value"}},chart:{client:{series:"series",category:"category",filter:"filter",column:"column",stackedcolumn:"stackedcolumn",bar:"bar",stackedbar:"stackedbar",line:"line",area:"area",pie:"pie",radar:"radar",gauge:"gauge"},server:{column:"COLUMN",stackedcolumn:"STACKED_COLUMN",bar:"BAR",stackedbar:"STACKED_BAR",line:"LINE",area:"AREA",pie:"PIE",radar:"RADAR",gauge:"GAUGE"}},data:{domain:"domain_",targetLine:"targetline_",baseLine:"baseline_",trendLine:"trendline_"},image:{png:"png",pdf:"pdf"},cmd:{init:"init_",none:"none_",urlparam:"id"},root:{id:"root"}};n.finals.chart.c2s={};n.finals.chart.s2c={};(function(){var t=n.finals.chart.client,w=n.finals.chart.server,v=n.finals.chart.c2s,u=n.finals.chart.s2c;v[t.column]=w.column;v[t.stackedcolumn]=w.stackedcolumn;v[t.bar]=w.bar;v[t.stackedbar]=w.stackedbar;v[t.line]=w.line;v[t.area]=w.area;v[t.pie]=w.pie;v[t.radar]=w.radar;v[t.gauge]=w.gauge;u[w.column]=t.column;u[w.stackedcolumn]=t.stackedcolumn;u[w.bar]=t.bar;u[w.stackedbar]=t.stackedbar;u[w.line]=t.line;u[w.area]=t.area;u[w.pie]=t.pie;u[w.radar]=t.radar;u[w.gauge]=t.gauge})();o=n.finals.dimension;o.objectNameMap={};o.objectNameMap[o.data.objectName]=o.data;o.objectNameMap[o.indicator.objectName]=o.indicator;o.objectNameMap[o.dataElement.objectName]=o.dataElement;o.objectNameMap[o.operand.objectName]=o.operand;o.objectNameMap[o.dataSet.objectName]=o.dataSet;o.objectNameMap[o.category.objectName]=o.category;o.objectNameMap[o.period.objectName]=o.period;o.objectNameMap[o.organisationUnit.objectName]=o.organisationUnit;o.objectNameMap[o.dimension.objectName]=o.dimension;n.period={periodTypes:[{id:"Daily",name:d.i18n.daily},{id:"Weekly",name:d.i18n.weekly},{id:"Monthly",name:d.i18n.monthly},{id:"BiMonthly",name:d.i18n.bimonthly},{id:"Quarterly",name:d.i18n.quarterly},{id:"SixMonthly",name:d.i18n.sixmonthly},{id:"SixMonthlyApril",name:d.i18n.sixmonthly_april},{id:"Yearly",name:d.i18n.yearly},{id:"FinancialOct",name:d.i18n.financial_oct},{id:"FinancialJuly",name:d.i18n.financial_july},{id:"FinancialApril",name:d.i18n.financial_april}]};n.valueType={numericTypes:["NUMBER","UNIT_INTERVAL","PERCENTAGE","INTEGER","INTEGER_POSITIVE","INTEGER_NEGATIVE","INTEGER_ZERO_OR_POSITIVE"],textTypes:["TEXT","LONG_TEXT","LETTER","PHONE_NUMBER","EMAIL"],booleanTypes:["BOOLEAN","TRUE_ONLY"],dateTypes:["DATE","DATETIME"],aggregateTypes:["NUMBER","UNIT_INTERVAL","PERCENTAGE","INTEGER","INTEGER_POSITIVE","INTEGER_NEGATIVE","INTEGER_ZERO_OR_POSITIVE","BOOLEAN","TRUE_ONLY"]};n.layout={west_width:424,west_fieldset_width:418,west_width_padding:2,west_fill:2,west_fill_accordion_indicator:81,west_fill_accordion_dataelement:81,west_fill_accordion_dataset:56,west_fill_accordion_eventdataitem:81,west_fill_accordion_programindicator:81,west_fill_accordion_period:310,west_fill_accordion_organisationunit:58,west_fill_accordion_group:31,west_maxheight_accordion_indicator:350,west_maxheight_accordion_dataelement:350,west_maxheight_accordion_dataset:350,west_maxheight_accordion_period:513,west_maxheight_accordion_organisationunit:500,west_maxheight_accordion_group:350,west_scrollbarheight_accordion_indicator:300,west_scrollbarheight_accordion_dataelement:300,west_scrollbarheight_accordion_dataset:300,west_scrollbarheight_accordion_period:450,west_scrollbarheight_accordion_organisationunit:450,west_scrollbarheight_accordion_group:300,east_tbar_height:31,east_gridcolumn_height:30,form_label_width:55,window_favorite_ypos:100,window_confirm_width:250,window_share_width:500,grid_favorite_width:420,grid_row_height:27,treepanel_minheight:135,treepanel_maxheight:400,treepanel_fill_default:310,treepanel_toolbar_menu_width_group:140,treepanel_toolbar_menu_width_level:120,multiselect_minheight:100,multiselect_maxheight:250,multiselect_fill_default:345,multiselect_fill_reportingrates:315};n.chart={style:{inset:30,fontFamily:"Arial,Sans-serif,Roboto,Helvetica,Consolas"},theme:{dv1:["#94ae0a","#1d5991","#a61120","#ff8809","#7c7474","#a61187","#ffd13e","#24ad9a","#a66111","#414141","#4500c4","#1d5700"]}};n.status={icon:{error:"error_s.png",warning:"warning.png",ok:"ok.png"}};n.report={digitGroupSeparator:{comma:",",space:" "}};n.url={analysisFields:["*","program[id,name]","programStage[id,name]","columns[dimension,filter,items[id,"+r.namePropertyUrl+"]]","rows[dimension,filter,items[id,"+r.namePropertyUrl+"]]","filters[dimension,filter,items[id,"+r.namePropertyUrl+"]]","!lastUpdated","!href","!created","!publicAccess","!rewindRelativePeriods","!userOrganisationUnit","!userOrganisationUnitChildren","!userOrganisationUnitGrandChildren","!externalAccess","!access","!relativePeriods","!columnDimensions","!rowDimensions","!filterDimensions","!user","!organisationUnitGroups","!itemOrganisationUnitGroups","!userGroupAccesses","!indicators","!dataElements","!dataElementOperands","!dataElementGroups","!dataSets","!periods","!organisationUnitLevels","!organisationUnits"]}}());(function(){l.layout={};l.layout.Record=function(t){var t=Ext.clone(t);return function(){if(!Ext.isObject(t)){console.log("api.layout.Record: config is not an object: "+t);return}if(!Ext.isString(t.id)){console.log("api.layout.Record: id is not text: "+t,true);return}return t}()};l.layout.Dimension=function(t){var t=Ext.clone(t);return function(){if(!Ext.isObject(t)){console.log("Dimension: config is not an object: "+t);return}if(!Ext.isString(t.dimension)){console.log("Dimension: name is not a string: "+t);return}if(t.dimension!==n.finals.dimension.category.objectName){var u=[];if(!Ext.isArray(t.items)){console.log("Dimension: items is not an array: "+t);return}for(var v=0;v<t.items.length;v++){u.push(l.layout.Record(t.items[v]))}t.items=Ext.Array.clean(u);if(!t.items.length){console.log("Dimension: has no valid items: "+t);return}}return t}()};l.layout.Layout=function(w,v,u){w=Ext.apply(w,v);var x={},t,y;t=function(A){var A=Ext.clone(A);if(!(A&&Ext.isArray(A)&&A.length)){return}for(var z=0;z<A.length;z++){A[z]=l.layout.Dimension(A[z])}A=Ext.Array.clean(A);return A.length?A:null};analytical2layout=function(A){var C=Ext.clone(A),D=o.category.objectName;A=Ext.clone(A);C.columns=[];C.rows=[];C.filters=C.filters||[];if(Ext.isArray(A.columns)&&A.columns.length){A.columns.reverse();for(var z=0,B;z<A.columns.length;z++){B=A.columns[z];if(B.dimension===D){continue}if(!C.columns.length){C.columns.push(B)}else{if(B.dimension===o.indicator.objectName){C.filters.push(C.columns.pop());C.columns=[B]}else{C.filters.push(B)}}}}if(Ext.isArray(A.rows)&&A.rows.length){A.rows.reverse();for(var z=0,B;z<A.rows.length;z++){B=A.rows[z];if(B.dimension===D){continue}if(!C.rows.length){C.rows.push(B)}else{if(B.dimension===o.indicator.objectName){C.filters.push(C.rows.pop());C.rows=[B]}else{C.filters.push(B)}}}}return C};y=function(){var B=n.finals.dimension,A,C={};if(!x){return}A=Ext.Array.clean([].concat(x.columns||[],x.rows||[],x.filters||[]));for(var z=0;z<A.length;z++){C[A[z].dimension]=A[z]}if(x.filters&&x.filters.length){for(var z=0;z<x.filters.length;z++){if(x.filters[z].dimension===B.indicator.objectName){p(d.i18n.indicators_cannot_be_specified_as_filter||"Indicators cannot be specified as filter.");return}if(x.filters[z].dimension===B.category.objectName){p(d.i18n.categories_cannot_be_specified_as_filter||"Categories cannot be specified as filter.");return}if(x.filters[z].dimension===B.dataSet.objectName){p(d.i18n.data_sets_cannot_be_specified_as_filter||"Data sets cannot be specified as filter.");return}}}if(C[B.operand.objectName]&&C[B.indicator.objectName]){p("Indicators and detailed data elements cannot be specified together.",true);return}if(C[B.operand.objectName]&&C[B.dataElement.objectName]){p("Detailed data elements and totals cannot be specified together.",true);return}if(C[B.operand.objectName]&&C[B.dataSet.objectName]){p("Data sets and detailed data elements cannot be specified together.",true);return}if(C[B.operand.objectName]&&C[B.category.objectName]){p("Categories and detailed data elements cannot be specified together.",true);return}if(C[B.indicator.objectName]&&w.aggregationType!=="DEFAULT"){p("Indicators and aggregation types cannot be specified together.",true);return}return true};return function(){var z=[],B=n.finals.dimension;if(!(w&&Ext.isObject(w))){p("Layout: config is not an object ("+r.el+")",true);return}w.columns=t(w.columns);w.rows=t(w.rows);w.filters=t(w.filters);if(!w.columns){p("No series items selected");return}if(!w.rows){p("No category items selected");return}for(var A=0,C=Ext.Array.clean([].concat(w.columns||[],w.rows||[],w.filters||[]));A<C.length;A++){if(l.layout.Dimension(C[A])){z.push(C[A].dimension)}}if(!Ext.Array.contains(z,B.period.objectName)){p("At least one period must be specified as series, category or filter");return}if(w.id){x.id=w.id}if(w.name){x.name=w.name}x.type=n.finals.chart.s2c[w.type]||n.finals.chart.client[w.type]||"column";x.columns=w.columns;x.rows=w.rows;x.filters=w.filters;x.showValues=Ext.isBoolean(w.showData)?w.showData:(Ext.isBoolean(w.showValues)?w.showValues:true);x.hideEmptyRows=Ext.isBoolean(w.hideEmptyRows)?w.hideEmptyRows:(Ext.isBoolean(w.hideEmptyRows)?w.hideEmptyRows:true);x.showTrendLine=Ext.isBoolean(w.regression)?w.regression:(Ext.isBoolean(w.showTrendLine)?w.showTrendLine:false);x.completedOnly=Ext.isBoolean(w.completedOnly)?w.completedOnly:false;x.targetLineValue=Ext.isNumber(w.targetLineValue)?w.targetLineValue:null;x.targetLineTitle=Ext.isString(w.targetLineLabel)&&!Ext.isEmpty(w.targetLineLabel)?w.targetLineLabel:(Ext.isString(w.targetLineTitle)&&!Ext.isEmpty(w.targetLineTitle)?w.targetLineTitle:null);x.baseLineValue=Ext.isNumber(w.baseLineValue)?w.baseLineValue:null;x.baseLineTitle=Ext.isString(w.baseLineLabel)&&!Ext.isEmpty(w.baseLineLabel)?w.baseLineLabel:(Ext.isString(w.baseLineTitle)&&!Ext.isEmpty(w.baseLineTitle)?w.baseLineTitle:null);x.sortOrder=Ext.isNumber(w.sortOrder)?w.sortOrder:0;x.aggregationType=Ext.isString(w.aggregationType)?w.aggregationType:"DEFAULT";x.rangeAxisMaxValue=Ext.isNumber(w.rangeAxisMaxValue)?w.rangeAxisMaxValue:null;x.rangeAxisMinValue=Ext.isNumber(w.rangeAxisMinValue)?w.rangeAxisMinValue:null;x.rangeAxisSteps=Ext.isNumber(w.rangeAxisSteps)?w.rangeAxisSteps:null;x.rangeAxisDecimals=Ext.isNumber(w.rangeAxisDecimals)?w.rangeAxisDecimals:null;x.rangeAxisTitle=Ext.isString(w.rangeAxisLabel)&&!Ext.isEmpty(w.rangeAxisLabel)?w.rangeAxisLabel:(Ext.isString(w.rangeAxisTitle)&&!Ext.isEmpty(w.rangeAxisTitle)?w.rangeAxisTitle:null);x.domainAxisTitle=Ext.isString(w.domainAxisLabel)&&!Ext.isEmpty(w.domainAxisLabel)?w.domainAxisLabel:(Ext.isString(w.domainAxisTitle)&&!Ext.isEmpty(w.domainAxisTitle)?w.domainAxisTitle:null);x.hideLegend=Ext.isBoolean(w.hideLegend)?w.hideLegend:false;x.hideTitle=Ext.isBoolean(w.hideTitle)?w.hideTitle:false;x.title=Ext.isString(w.title)&&!Ext.isEmpty(w.title)?w.title:null;x.parentGraphMap=Ext.isObject(w.parentGraphMap)?w.parentGraphMap:null;if(Ext.isString(w.displayProperty)){x.displayProperty=w.displayProperty}if(Ext.Array.from(w.userOrgUnit).length){x.userOrgUnit=Ext.Array.from(w.userOrgUnit)}if(Ext.isObject(w.program)){x.program=w.program}if(q.prototype.date.getYYYYMMDD(w.relativePeriodDate)){x.relativePeriodDate=q.prototype.date.getYYYYMMDD(w.relativePeriodDate)}if(Ext.isObject(w.domainAxisStyle)){x.domainAxisStyle=w.domainAxisStyle}if(Ext.isObject(w.rangeAxisStyle)){x.rangeAxisStyle=w.rangeAxisStyle}if(Ext.isObject(w.legendStyle)){x.legendStyle=w.legendStyle}if(Ext.isObject(w.seriesStyle)){x.seriesStyle=w.seriesStyle}if(!y()){return}return Ext.apply(x,u)}()};l.response={};l.response.Header=function(t){var t=Ext.clone(t);return function(){if(!Ext.isObject(t)){console.log("Header: config is not an object: "+t);return}if(!Ext.isString(t.name)){console.log("Header: name is not a string: "+t);return}if(!Ext.isBoolean(t.meta)){console.log("Header: meta is not boolean: "+t);return}return t}()};l.response.Response=function(t){var t=Ext.clone(t);return function(){if(!(t&&Ext.isObject(t))){console.log("Response: config is not an object");return}if(!(t.headers&&Ext.isArray(t.headers))){console.log("Response: headers is not an array");return}for(var u=0,v;u<t.headers.length;u++){t.headers[u]=l.response.Header(t.headers[u])}t.headers=Ext.Array.clean(t.headers);if(!t.headers.length){console.log("Response: no valid headers");return}if(!(Ext.isArray(t.rows)&&t.rows.length>0)){}if(t.rows.length&&t.headers.length!==t.rows[0].length){console.log("api.response.Response: headers.length !== rows[0].length")}return t}()}}());(function(){q.prototype={};q.prototype.array={};q.prototype.array.getLength=function(u,t){if(!Ext.isArray(u)){if(!t){console.log("support.prototype.array.getLength: not an array")}return null}return u.length};q.prototype.array.getMaxLength=function(w,v){if(!Ext.isArray(w)){if(!v){console.log("support.prototype.array.getLength: not an array")}return null}var t=0;for(var u=0;u<w.length;u++){if(Ext.isString(w[u])&&w[u].length>t){t=w[u].length}}return t};q.prototype.array.sort=function(w,v,u,t){if(!q.prototype.array.getLength(w)){return}u=!!u||Ext.isNumber(u)?u:"name";w.sort(function(y,x){if(Ext.isObject(y)&&Ext.isObject(x)){y=y[u];x=x[u]}if(Ext.isArray(y)&&Ext.isArray(x)){y=y[u];x=x[u]}if(Ext.isString(y)&&Ext.isString(x)){y=y.toLowerCase();x=x.toLowerCase();if(v==="DESC"){return y<x?1:(y>x?-1:0)}else{return y<x?-1:(y>x?1:0)}}else{if(Ext.isNumber(y)&&Ext.isNumber(x)){return v==="DESC"?x-y:y-x}else{if(y===undefined||y===null){return t?-1:1}else{if(x===undefined||x===null){return t?1:-1}}}}return -1});return w};q.prototype.array.deleteObjectKey=function(v,u){if(!(Ext.isArray(v)&&Ext.isDefined(u))){return}for(var t=0;t<v.length;t++){delete v[t][u]}};q.prototype.object={};q.prototype.object.getLength=function(t,w){if(!Ext.isObject(t)){if(!w){console.log("support.prototype.object.getLength: not an object")}return null}var v=0;for(var u in t){if(t.hasOwnProperty(u)){v++}}return v};q.prototype.object.hasObject=function(u,x,w){if(!q.prototype.object.getLength(u)){return null}for(var v in u){var t=u[v];if(u.hasOwnProperty(v)&&t[x]===w){return true}}return null};q.prototype.number={};q.prototype.number.prettyPrint=function(t,u){u=u||"space";if(!(Ext.isNumber(t)||Ext.isString(t))){return}if(u==="none"){return t}return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,n.report.digitGroupSeparator[u])};q.prototype.str={};q.prototype.str.replaceAll=function(t,w,v){if(Ext.isString(t)){t=t.split(w).join(v)}else{if(Ext.isArray(t)){for(var u=0;u<t.length;u++){t[u]=t[u].split(w).join(v)}}}return t};q.prototype.date={};q.prototype.date.getYYYYMMDD=function(w){if(!Ext.isString(w)){if(!(Object.prototype.toString.call(w)==="[object Date]"&&w.toString()!=="Invalid date")){return null}}var u=new Date(w),v=""+(1+u.getMonth()),t=""+u.getDate();v=v.length===1?"0"+v:v;t=t.length===1?"0"+t:t;return u.getFullYear()+"-"+v+"-"+t};q.connection={};q.connection.ajax=function(t,u){if(u.crossDomain&&Ext.isString(u.username)&&Ext.isString(u.password)){t.headers=Ext.isObject(u.headers)?u.headers:{};t.headers.Authorization="Basic "+btoa(u.username+":"+u.password)}Ext.Ajax.request(t)}}());(function(){m.layout={};m.layout.cleanDimensionArray=function(u){if(!q.prototype.array.getLength(u)){return null}var v=[];for(var t=0;t<u.length;t++){v.push(l.layout.Dimension(u[t]))}v=Ext.Array.clean(v);return v.length?v:null};m.layout.sortDimensionArray=function(w,v){if(!q.prototype.array.getLength(w,true)){return null}w=m.layout.cleanDimensionArray(w);if(!w){console.log("service.layout.sortDimensionArray: no valid dimensions");return null}v=v||"dimensionName";Ext.Array.sort(w,function(y,x){if(y[v]<x[v]){return -1}if(y[v]>x[v]){return 1}return 0});for(var u=0,t;u<w.length;u++){q.prototype.array.sort(w[u].items,"ASC","id");if(q.prototype.array.getLength(w[u].ids)){q.prototype.array.sort(w[u].ids)}}return w};m.layout.getObjectNameDimensionMapFromDimensionArray=function(w){var v={};if(!q.prototype.array.getLength(w)){return null}for(var t=0,u;t<w.length;t++){u=l.layout.Dimension(w[t]);if(u){v[u.dimension]=u}}return q.prototype.object.getLength(v)?v:null};m.layout.getObjectNameDimensionItemsMapFromDimensionArray=function(w){var v={};if(!q.prototype.array.getLength(w)){return null}for(var t=0,u;t<w.length;t++){u=l.layout.Dimension(w[t]);if(u){v[u.dimension]=u.items}}return q.prototype.object.getLength(v)?v:null};m.layout.getExtendedLayout=function(y){var y=Ext.clone(y),A;A={columns:[],rows:[],filters:[],columnObjectNames:[],columnDimensionNames:[],rowObjectNames:[],rowDimensionNames:[],axisDimensions:[],axisObjectNames:[],axisDimensionNames:[],sortedAxisDimensionNames:[],filterDimensions:[],filterObjectNames:[],filterDimensionNames:[],sortedFilterDimensions:[],dimensions:[],objectNames:[],dimensionNames:[],objectNameDimensionsMap:{},objectNameItemsMap:{},objectNameIdsMap:{},dimensionNameDimensionsMap:{},dimensionNameItemsMap:{},dimensionNameIdsMap:{},dimensionNameSortedIdsMap:{},dimensionNameAxisMap:{}};Ext.applyIf(A,y);if(y.columns){for(var w=0,x,z,t;w<y.columns.length;w++){x=y.columns[w];z=x.items;t={};t.dimension=x.dimension;t.objectName=x.dimension;t.dimensionName=o.objectNameMap[x.dimension].dimensionName;if(z){t.items=z;t.ids=[];for(var v=0;v<z.length;v++){t.ids.push(z[v].id)}}A.columns.push(t);A.columnObjectNames.push(t.objectName);A.columnDimensionNames.push(t.dimensionName);A.axisDimensions.push(t);A.axisObjectNames.push(t.objectName);A.axisDimensionNames.push(o.objectNameMap[t.objectName].dimensionName);A.objectNameDimensionsMap[t.objectName]=t;A.objectNameItemsMap[t.objectName]=t.items;A.objectNameIdsMap[t.objectName]=t.ids;A.dimensionNameAxisMap[t.dimensionName]=A.columns}}if(y.rows){for(var w=0,x,z,t;w<y.rows.length;w++){x=Ext.clone(y.rows[w]);z=x.items;t={};t.dimension=x.dimension;t.objectName=x.dimension;t.dimensionName=o.objectNameMap[x.dimension].dimensionName;if(z){t.items=z;t.ids=[];for(var v=0;v<z.length;v++){t.ids.push(z[v].id)}}A.rows.push(t);A.rowObjectNames.push(t.objectName);A.rowDimensionNames.push(t.dimensionName);A.axisDimensions.push(t);A.axisObjectNames.push(t.objectName);A.axisDimensionNames.push(o.objectNameMap[t.objectName].dimensionName);A.objectNameDimensionsMap[t.objectName]=t;A.objectNameItemsMap[t.objectName]=t.items;A.objectNameIdsMap[t.objectName]=t.ids;A.dimensionNameAxisMap[t.dimensionName]=A.rows}}if(y.filters){for(var w=0,x,z,t;w<y.filters.length;w++){x=y.filters[w];z=x.items;t={};t.dimension=x.dimension;t.objectName=x.dimension;t.dimensionName=o.objectNameMap[x.dimension].dimensionName;if(z){t.items=z;t.ids=[];for(var v=0;v<z.length;v++){t.ids.push(z[v].id)}}A.filters.push(t);A.filterDimensions.push(t);A.filterObjectNames.push(t.objectName);A.filterDimensionNames.push(o.objectNameMap[t.objectName].dimensionName);A.objectNameDimensionsMap[t.objectName]=t;A.objectNameItemsMap[t.objectName]=t.items;A.objectNameIdsMap[t.objectName]=t.ids;A.dimensionNameAxisMap[t.dimensionName]=A.filters}}A.legendSet=y.legendSet?r.idLegendSetMap[y.legendSet.id]:null;if(y.legendSet&&y.legendSet.legends){A.legendSet=r.idLegendSetMap[y.legendSet.id];q.prototype.array.sort(A.legendSet.legends,"ASC","startValue")}A.axisDimensionNames=Ext.Array.unique(A.axisDimensionNames);A.filterDimensionNames=Ext.Array.unique(A.filterDimensionNames);A.columnDimensionNames=Ext.Array.unique(A.columnDimensionNames);A.rowDimensionNames=Ext.Array.unique(A.rowDimensionNames);A.filterDimensionNames=Ext.Array.unique(A.filterDimensionNames);A.sortedAxisDimensionNames=Ext.clone(A.axisDimensionNames).sort();A.sortedFilterDimensions=m.layout.sortDimensionArray(Ext.clone(A.filterDimensions));A.dimensions=[].concat(A.axisDimensions,A.filterDimensions);A.objectNames=[].concat(A.axisObjectNames,A.filterObjectNames);A.dimensionNames=[].concat(A.axisDimensionNames,A.filterDimensionNames);for(var w=0,u;w<A.dimensionNames.length;w++){u=A.dimensionNames[w];A.dimensionNameDimensionsMap[u]=[];A.dimensionNameItemsMap[u]=[];A.dimensionNameIdsMap[u]=[]}for(var w=0,t;w<A.dimensions.length;w++){t=A.dimensions[w];A.dimensionNameDimensionsMap[t.dimensionName].push(t);A.dimensionNameItemsMap[t.dimensionName]=A.dimensionNameItemsMap[t.dimensionName].concat(t.items);A.dimensionNameIdsMap[t.dimensionName]=A.dimensionNameIdsMap[t.dimensionName].concat(t.ids)}for(var B in A.dimensionNameIdsMap){if(A.dimensionNameIdsMap.hasOwnProperty(B)){A.dimensionNameSortedIdsMap[B]=Ext.clone(A.dimensionNameIdsMap[B]).sort()}}A.tableUuid=r.el+"_"+Ext.data.IdGenerator.get("uuid").generate();return A};m.layout.getSyncronizedXLayout=function(C,t){var x=Ext.Array.clean([].concat(C.columns||[],C.rows||[],C.filters||[])),L=C.objectNameDimensionsMap[o.organisationUnit.objectName],z=L&&Ext.Array.contains(L.ids,"USER_ORGUNIT"),N=L&&Ext.Array.contains(L.ids,"USER_ORGUNIT_CHILDREN"),K=L&&Ext.Array.contains(L.ids,"USER_ORGUNIT_GRANDCHILDREN"),u=function(){if(L&&Ext.isArray(L.ids)){for(var P=0;P<L.ids.length;P++){if(L.ids[P].substr(0,5)==="LEVEL"){return true}}}return false}(),B=function(){if(L&&Ext.isArray(L.ids)){for(var P=0;P<L.ids.length;P++){if(L.ids[P].substr(0,8)==="OU_GROUP"){return true}}}return false}(),y=o.category.objectName,w=o.organisationUnit.objectName,v=function(){var Q=[];for(var P=0;P<t.headers.length;P++){Q.push(t.headers[P].name)}return Q}(),O;for(var I=0,G,A,D;I<x.length;I++){G=x[I];G.items=[];A=t.metaData[G.objectName];if(Ext.isArray(A)&&A.length){var E=Ext.clone(t.metaData[G.dimensionName]);for(var F=0;F<E.length;F++){G.items.push({id:E[F],name:t.metaData.names[E[F]]})}}else{G.items=Ext.clone(C.objectNameItemsMap[G.objectName])}}x=Ext.Array.clean([].concat(C.columns||[],C.rows||[],C.filters||[]));for(var I=0,H=t.metaData.names,J;I<x.length;I++){J=x[I].items;if(Ext.isArray(J)&&J.length){for(var F=0,M;F<J.length;F++){M=J[F];if(Ext.isObject(M)&&Ext.isString(H[M.id])&&!Ext.isString(M.name)){M.name=H[M.id]||""}}}}O=l.layout.Layout(C);if(O){return m.layout.getExtendedLayout(O)}return null};m.layout.layout2plugin=function(y,v){var y=Ext.clone(y),x=Ext.Array.clean([].concat(y.columns||[],y.rows||[],y.filters||[]));y.url=r.contextPath;if(v){y.el=v}if(Ext.isString(y.id)){return{id:y.id}}for(var u=0,z,w;u<x.length;u++){z=x[u];delete z.id;delete z.ids;delete z.type;delete z.dimensionName;delete z.objectName;for(var t=0,w;t<z.items.length;t++){w=z.items[t];delete w.name;delete w.code;delete w.created;delete w.lastUpdated;delete w.value}}if(!y.hideEmptyRows){delete y.hideEmptyRows}if(!y.showTrendLine){delete y.showTrendLine}if(!y.completedOnly){delete y.completedOnly}if(!y.targetLineValue){delete y.targetLineValue}if(!y.targetLineTitle){delete y.targetLineTitle}if(!y.baseLineValue){delete y.baseLineValue}if(!y.baseLineTitle){delete y.baseLineTitle}if(!y.hideLegend){delete y.hideLegend}if(!y.hideTitle){delete y.hideTitle}if(!y.title){delete y.title}if(!y.domainAxisTitle){delete y.domainAxisTitle}if(!y.rangeAxisTitle){delete y.rangeAxisTitle}if(!y.rangeAxisMaxValue){delete y.rangeAxisMaxValue}if(!y.rangeAxisMinValue){delete y.rangeAxisMinValue}if(!y.rangeAxisSteps){delete y.rangeAxisSteps}if(!y.rangeAxisDecimals){delete y.rangeAxisDecimals}if(!y.sorting){delete y.sorting}if(!y.legend){delete y.legend}if(y.aggregationType==="DEFAULT"){delete y.aggregationType}if(y.showValues){delete y.showValues}delete y.parentGraphMap;delete y.reportingPeriod;delete y.organisationUnit;delete y.parentOrganisationUnit;delete y.regression;delete y.cumulative;delete y.topLimit;return y};m.layout.analytical2layout=function(u){var w=Ext.clone(u),x=o.category.objectName;u=Ext.clone(u);w.columns=[];w.rows=[];w.filters=w.filters||[];if(Ext.isArray(u.columns)&&u.columns.length){u.columns.reverse();for(var t=0,v;t<u.columns.length;t++){v=u.columns[t];if(v.dimension===x){continue}if(!w.columns.length){w.columns.push(v)}else{if(v.dimension===o.indicator.objectName){w.filters.push(w.columns.pop());w.columns=[v]}else{w.filters.push(v)}}}}if(Ext.isArray(u.rows)&&u.rows.length){u.rows.reverse();for(var t=0,v;t<u.rows.length;t++){v=u.rows[t];if(v.dimension===x){continue}if(!w.rows.length){w.rows.push(v)}else{if(v.dimension===o.indicator.objectName){w.filters.push(w.rows.pop());w.rows=[v]}else{w.filters.push(v)}}}}return w};m.response={};m.response.getExtendedResponse=function(u,t){var v=[];t.nameHeaderMap={};t.idValueMap={};(function(){for(var w=0,x;w<t.headers.length;w++){x=t.headers[w];x.index=w;if(x.meta){x.ids=Ext.clone(u.dimensionNameIdsMap[x.name])||[];x.size=x.ids.length;v=v.concat(x.ids)}}for(var w=0,x;w<t.headers.length;w++){x=t.headers[w];t.nameHeaderMap[x.name]=x}}());(function(){var D=t.nameHeaderMap[n.finals.dimension.value.value].index,x=t.nameHeaderMap[n.finals.dimension.category.dimensionName],H=o.data.dimensionName,E=o.category.dimensionName,A=u.axisDimensionNames,F=[];for(var B=0,y,C;B<A.length;B++){y=A[B];F.push(t.nameHeaderMap[A[B]].index);if(x&&!Ext.Array.contains(A,E)&&A[B]===H){F.push(x.index)}}for(var B=0,G,w;B<t.rows.length;B++){G=t.rows[B];w="";for(var z=0;z<F.length;z++){w+=G[F[z]]}t.idValueMap[w]=G[D]}}());return t};m.legend={};m.legend.getColorByValue=function(x,w){var t;if(!(x&&w)){return}for(var u=0,v;u<x.legends.length;u++){v=x.legends[u];if(w>=parseFloat(v.startValue)&&w<parseFloat(v.endValue)){return v.color}}return}}());(function(){k.mask={};k.mask.show=function(t,u){if(r.skipMask){return}if(!Ext.isObject(t)){console.log("support.gui.mask.show: component not an object");return null}u=u||"Loading..";if(t.mask&&t.mask.destroy){t.mask.destroy();t.mask=null}t.mask=new Ext.create("Ext.LoadMask",t,{shadow:false,message:u,style:"box-shadow:0",bodyStyle:"box-shadow:0"});t.mask.show()};k.mask.hide=function(t){if(r.skipMask){return}if(!Ext.isObject(t)){console.log("support.gui.mask.hide: component not an object");return null}if(t.mask&&t.mask.destroy){t.mask.destroy();t.mask=null}};k.window={};k.window.setAnchorPosition=function(t,z){var v=j.getViewportWidth(),x=z?z.getPosition()[0]:4,u=t.getWidth(),A=z?z.getPosition()[1]+z.getHeight()+4:33;if((x+u)>v){t.setPosition((v-u-2),A)}else{t.setPosition(x,A)}};k.window.addHideOnBlurHandler=function(t){var v=Ext.query(".x-mask"),u=Ext.get(v[0]);u.on("click",function(){if(t.hideOnBlur){t.hide()}});t.hasHideOnBlurHandler=true};k.window.addDestroyOnBlurHandler=function(t){var v=Ext.query(".x-mask"),u=Ext.get(v[0]);u.on("click",function(){if(t.destroyOnBlur){t.destroy()}});t.hasDestroyOnBlurHandler=true};k.message={};k.message.alert=function(w){var t={},u,v;if(!w||(Ext.isObject(w)&&!w.message&&!w.responseText)){return}if(Ext.isObject(w)&&w.responseText&&!w.message){w=Ext.decode(w.responseText)}if(Ext.isString(w)){w={status:"ERROR",message:w}}u=(w.status||"INFO").toLowerCase();t.title=w.status;t.iconCls="ns-window-title-messagebox "+u;t.html="";t.html+=w.httpStatusCode?"Code: "+w.httpStatusCode+"<br>":"";t.html+=w.httpStatus?"Status: "+w.httpStatus+"<br><br>":"";t.html+=w.message+(w.message.substr(w.message.length-1)==="."?"":".");t.bodyStyle="padding: 12px; background: #fff; max-width: 600px; max-height: "+j.getCenterRegionHeight()/2+"px";t.modal=true;t.destroyOnBlur=true;t.listeners={show:function(x){x.setPosition(x.getPosition()[0],x.getPosition()[1]/2);if(!x.hasDestroyOnBlurHandler){k.window.addDestroyOnBlurHandler(x)}}};v=Ext.create("Ext.window.Window",t);v.show()};k.analytics={};k.analytics.getParamString=function(F,w){var A=w?F.sortedAxisDimensionNames:F.axisDimensionNames,H=w?F.sortedFilterDimensions:F.filterDimensions,t=w?F.dimensionNameSortedIdsMap:F.dimensionNameIdsMap,x="?",v=false,u=F.dimensionNameItemsMap,I=o.indicator.dimensionName,E=o.category.dimensionName,z=["COUNT","SUM","STDDEV","VARIANCE","MIN","MAX"],G=F.displayProperty||r.userAccount.settings.keyAnalysisDisplayProperty||"name";for(var B=0,y,D;B<A.length;B++){y=A[B];x+="dimension="+y;D=Ext.clone(t[y]);if(y===I){D=Ext.Array.unique(D)}if(y!==E){x+=":"+D.join(";")}if(B<(A.length-1)){x+="&"}}if(v){x+="&dimension="+n.finals.dimension.category.dimensionName}if(Ext.isArray(H)&&H.length){for(var B=0,C;B<H.length;B++){C=H[B];x+="&filter="+C.dimensionName+":"+C.ids.join(";")}}if(F.completedOnly){x+="&completedOnly=true"}if(Ext.Array.contains(z,F.aggregationType)){x+="&aggregationType="+F.aggregationType}x+="&displayProperty="+G.toUpperCase();if(Ext.isArray(F.userOrgUnit)&&F.userOrgUnit.length){x+="&userOrgUnit=";for(var B=0;B<F.userOrgUnit.length;B++){x+=F.userOrgUnit[B]+(B<F.userOrgUnit.length-1?";":"")}}if(F.program&&F.program.id){x+="&program="+F.program.id}if(F.relativePeriodDate){x+="&relativePeriodDate="+F.relativePeriodDate}return x.replace(/#/g,".")};k.analytics.validateUrl=function(u){var v;if(Ext.isIE){v="Too many items selected (url has "+u.length+" characters). Internet Explorer accepts maximum 2048 characters."}else{var t=u.length>8000?"8000":(u.length>4000?"4000":"2000");v="Too many items selected (url has "+u.length+" characters). Please reduce to less than "+t+" characters."}v+="\n\nHint: A good way to reduce the number of items is to use relative periods and level/group organisation unit selection modes.";p(v,"warning")};k.chart={};k.chart.createChart=function(O,C,x){var u=O.columnDimensionNames[0]?O.dimensionNameIdsMap[O.columnDimensionNames[0]]:[],F=[],L={},G=function(){for(var Z=0,aa;Z<u.length;Z++){aa=Ext.data.IdGenerator.get("uuid").generate();F.push(aa);L[aa]=u[Z];C.metaData.names[aa]=C.metaData.names[u[Z]]}}(),y=O.rowDimensionNames[0]?O.dimensionNameIdsMap[O.rowDimensionNames[0]]:[],M=function(){var aa=[];if(O.filters){for(var Z=0;Z<O.filters.length;Z++){aa=aa.concat(O.filters[Z].ids||[])}}return aa}(),E=Ext.data.IdGenerator.get("uuid").generate(),D=function(ad,ab){for(var aa=0,ae,ac;aa<ad.length;aa++){ae=ad[aa];ac=0;for(var Z=0;Z<ab.length;Z++){ac+=parseFloat(ae[ab[Z]]);ae[E]=ac}}},I,z,Q,A,W,Y,U,v,V,H,T,P,X,B,N,w,S,R,K,J,t={};A=function(ae){var at=[],aa=[],ar=[],ab=[],ac;for(var aq=0,ah,an,aj,ai;aq<y.length;aq++){ah={};an=y[aq];aj=[];ai=false;ah[n.finals.data.domain]=C.metaData.names[an];for(var ao=0,ak,am;ao<u.length;ao++){ak=u[ao]+y[aq];am=C.idValueMap[ak];aj.push(am);ah[F[ao]]=am?parseFloat(am):"0.0"}ai=!(Ext.Array.clean(aj).length);if(!(ai&&O.hideEmptyRows)){at.push(ah)}}if(ae){D(at,F)}if(O.sortOrder){var af=ae?E:F[0],Z="sorting_"+Ext.data.IdGenerator.get("uuid").generate();for(var ag=0,ad;ag<at.length;ag++){ad=at[ag];ad[Z]=ad[af]==="0.0"?null:ad[af]}q.prototype.array.sort(at,O.sortOrder===-1?"ASC":"DESC",Z,(O.sortOrder===-1));q.prototype.array.deleteObjectKey(at,Z)}if(O.showTrendLine){var ap,al;if(ae){ap=new e();al=n.finals.data.trendLine+E;for(var aq=0,am;aq<at.length;aq++){am=at[aq][E];ap.addData(aq,parseFloat(am))}for(var aq=0;aq<at.length;aq++){at[aq][al]=parseFloat(ap.predict(aq).toFixed(1))}aa.push(al);C.metaData.names[al]=d.i18n.trend+" (Total)"}else{for(var aq=0;aq<F.length;aq++){ap=new e();al=n.finals.data.trendLine+F[aq];for(var ao=0,am;ao<at.length;ao++){am=at[ao][F[aq]];ap.addData(ao,parseFloat(am))}for(var ao=0;ao<at.length;ao++){at[ao][al]=parseFloat(ap.predict(ao).toFixed(1))}aa.push(al);C.metaData.names[al]=d.i18n.trend+(s.dashboard?"":" ("+C.metaData.names[F[aq]]+")")}}}if(Ext.isNumber(O.targetLineValue)||Ext.isNumber(parseFloat(O.targetLineValue))){for(var aq=0;aq<at.length;aq++){at[aq][n.finals.data.targetLine]=parseFloat(O.targetLineValue)}ar.push(n.finals.data.targetLine)}if(Ext.isNumber(O.baseLineValue)||Ext.isNumber(parseFloat(O.baseLineValue))){for(var aq=0;aq<at.length;aq++){at[aq][n.finals.data.baseLine]=parseFloat(O.baseLineValue)}ab.push(n.finals.data.baseLine)}ac=Ext.create("Ext.data.Store",{fields:function(){var au=Ext.clone(F);au.push(n.finals.data.domain);au=au.concat(aa,ar,ab);return au}(),data:at});ac.rangeFields=F;ac.domainFields=[n.finals.data.domain];ac.trendLineFields=aa;ac.targetLineFields=ar;ac.baseLineFields=ab;ac.numericFields=[].concat(ac.rangeFields,ac.trendLineFields,ac.targetLineFields,ac.baseLineFields);ac.getMaximum=function(){var av=[];for(var au=0;au<ac.numericFields.length;au++){av.push(ac.max(ac.numericFields[au]))}return Ext.Array.max(av)};ac.getMinimum=function(){var av=[];for(var au=0;au<ac.numericFields.length;au++){av.push(ac.min(ac.numericFields[au]))}return Ext.Array.min(av)};ac.getMaximumSum=function(){var av=[],au=0;ac.each(function(aw){au=0;for(var ax=0;ax<ac.rangeFields.length;ax++){au+=aw.data[ac.rangeFields[ax]]}av.push(au)});return Ext.Array.max(av)};ac.hasDecimals=function(){var au=ac.getRange();for(var aw=0;aw<au.length;aw++){for(var av=0,ax;av<ac.rangeFields.length;av++){ax=au[aw].data[ac.rangeFields[av]];if(Ext.isNumber(ax)&&(ax%1)){return true}}}return false};ac.getNumberOfDecimals=function(){var av=ac.getRange(),au=[];for(var ax=0;ax<av.length;ax++){for(var aw=0,ay;aw<ac.rangeFields.length;aw++){ay=av[ax].data[ac.rangeFields[aw]];if(Ext.isNumber(ay)&&(ay%1)){ay=ay.toString();au.push(ay.length-ay.indexOf(".")-1)}}}return Ext.Array.max(au)};if(d.isDebug){console.log("data",at);console.log("rangeFields",ac.rangeFields);console.log("domainFields",ac.domainFields);console.log("trendLineFields",ac.trendLineFields);console.log("targetLineFields",ac.targetLineFields);console.log("baseLineFields",ac.baseLineFields)}return ac};W=function(aj){var ag="normal 11px "+n.chart.style.fontFamily,ak="black",al=0,ad="bold 12px "+n.chart.style.fontFamily,Z="black",ae=n.finals.chart,ah=aj.getMinimum(),af,ac,ab;getRenderer=function(am){var ao="0.";for(var an=0;an<am;an++){ao+="0"}return ao};if((O.type===ae.stackedcolumn||O.type===ae.stackedbar)&&(O.showTrendLine||O.targetLineValue||O.baseLineValue)){var ai=[aj.getMaximum(),aj.getMaximumSum()];af=Math.ceil(Ext.Array.max(ai)*1.1);af=Math.floor(af/10)*10}ac=aj.getNumberOfDecimals();renderer=!!ac&&(aj.getMaximum()<20)?getRenderer(ac):"0,0";ab={type:"Numeric",position:"left",fields:aj.numericFields,minimum:ah<0?ah:0,label:{renderer:function(am){return q.prototype.number.prettyPrint(am)},style:{},rotate:{}},labelTitle:{},grid:{odd:{opacity:1,stroke:"#000","stroke-width":0.03},even:{opacity:1,stroke:"#000","stroke-width":0.03}}};if(af){ab.maximum=af}if(O.rangeAxisMaxValue){ab.maximum=O.rangeAxisMaxValue}if(O.rangeAxisMinValue){ab.minimum=O.rangeAxisMinValue}if(O.rangeAxisSteps){ab.majorTickSteps=O.rangeAxisSteps-1}if(O.rangeAxisDecimals){ab.label.renderer=Ext.util.Format.numberRenderer(getRenderer(O.rangeAxisDecimals))}if(O.rangeAxisTitle){ab.title=O.rangeAxisTitle}if(Ext.isObject(O.rangeAxisStyle)){var aa=O.rangeAxisStyle;ak=aa.labelColor||ak;if(aa.labelFont){ag=aa.labelFont}else{ag=aa.labelFontWeight?aa.labelFontWeight+" ":"normal ";ag+=aa.labelFontSize?parseFloat(aa.labelFontSize)+"px ":"11px ";ag+=aa.labelFontFamily?aa.labelFontFamily:n.chart.style.fontFamily}if(Ext.isNumber(parseFloat(aa.labelRotation))){al=360-parseFloat(aa.labelRotation)}Z=aa.titleColor||Z;if(aa.titleFont){ad=aa.titleFont}else{ad=aa.titleFontWeight?aa.titleFontWeight+" ":"bold ";ad+=aa.titleFontSize?parseFloat(aa.titleFontSize)+"px ":"12px ";ad+=aa.titleFontFamily?aa.titleFontFamily:n.chart.style.fontFamily}}ab.label.style.fill=ak;ab.label.style.font=ag;ab.label.rotate.degrees=al;ab.labelTitle.fill=Z;ab.labelTitle.font=ad;return ab};Y=function(Z){var ag="normal 11px "+n.chart.style.fontFamily,af="black",aa=315,ad="bold 12px "+n.chart.style.fontFamily,ae="black",ac={type:"Category",position:"bottom",fields:Z.domainFields,label:{rotate:{},style:{}},labelTitle:{}};if(O.domainAxisTitle){ac.title=O.domainAxisTitle}if(Ext.isObject(O.domainAxisStyle)){var ab=O.domainAxisStyle;af=ab.labelColor||af;if(ab.labelFont){ag=ab.labelFont}else{ag=ab.labelFontWeight?ab.labelFontWeight+" ":"normal ";ag+=ab.labelFontSize?parseFloat(ab.labelFontSize)+"px ":"11px ";ag+=ab.labelFontFamily?ab.labelFontFamily:n.chart.style.fontFamily}if(Ext.isNumber(parseFloat(ab.labelRotation))){aa=360-parseFloat(ab.labelRotation)}ae=ab.titleColor||ae;if(ab.titleFont){ad=ab.titleFont}else{ad=ab.titleFontWeight?ab.titleFontWeight+" ":"bold ";ad+=ab.titleFontSize?parseFloat(ab.titleFontSize)+"px ":"12px ";ad+=ab.titleFontFamily?ab.titleFontFamily:n.chart.style.fontFamily}}ac.label.style.fill=af;ac.label.style.font=ag;ac.label.rotate.degrees=aa;ac.labelTitle.fill=ae;ac.labelTitle.font=ad;return ac};U=function(ac){var ae=s.dashboard?23:30,ab=s.dashboard?5:6,ag=ac.length,ai,aj=ag*ae,aa=q.prototype.array.getMaxLength(ac),ad=10,ah=j.getCenterRegionWidth(),Z,af;getValidatedTitles=function(ao,ap){var at=ao.length,aq,av;ad=ap<ad?ap:ad;for(var an=ap,al;an>0;an--){aq=[];for(var am=0,ar,au,ak;am<ao.length;am++){ar=ao[am];aq.push(ar.length>an?(ar.slice(0,an)+".."):ar)}au=aq.join("").length;al=aj+(au*ab);if(an===ad){av=Ext.clone(aq)}if(al<ah){return aq}}return av};return getValidatedTitles(ac,aa)};v=function(ab){var aa=[],Z=Ext.isObject(O.legendStyle)?O.legendStyle:null;if(Z&&Ext.isArray(Z.labelNames)){return Z.labelNames}else{for(var ae=0,ag,ad,ac,af;ae<ab.rangeFields.length;ae++){ag=L[ab.rangeFields[ae]];ad=C.metaData.names[ag];if(Z&&Z.labelMaxLength){var ac=parseInt(Z.labelMaxLength);if(Ext.isNumber(ac)&&ad.length>ac){ad=ad.substr(0,ac)+".."}}aa.push(ad)}}return s.dashboard?U(aa):aa};V=function(ab){var aa=[],Z=Ext.isObject(O.legendStyle)?O.legendStyle:null;if(Z&&Ext.isArray(Z.labelNames)){return Z.labelNames}else{var ad=ab.domainFields[0],ac;ab.each(function(af){ac=af.data[ad];if(Z&&Z.labelMaxLength){var ae=parseInt(Z.labelMaxLength);if(Ext.isNumber(ae)&&ac.length>ae){ac=ac.substr(0,ae)+".."}}aa.push(ac)})}return s.dashboard?U(aa):aa};H=function(aa){var Z={type:"column",axis:"left",xField:aa.domainFields,yField:aa.rangeFields,style:{opacity:0.8,lineWidth:3},markerConfig:{type:"circle",radius:4},tips:B(),title:v(aa)};if(O.showValues){var ad=n.chart.style.fontFamily,ac="black";if(Ext.isObject(O.seriesStyle)){var ab=O.seriesStyle;ac=ab.labelColor||ac;if(ab.labelFont){ad=ab.labelFont}else{ad=ab.labelFontWeight?ab.labelFontWeight+" ":"normal ";ad+=ab.labelFontSize?parseFloat(ab.labelFontSize)+"px ":"11px ";ad+=ab.labelFontFamily?ab.labelFontFamily:n.chart.style.fontFamily}}Z.label={display:"outside","text-anchor":"middle",field:aa.rangeFields,font:ad,fill:ac,renderer:function(ae){ae=ae==="0.0"?"":ae;return q.prototype.number.prettyPrint(ae)}}}return Z};T=function(aa,ad){var Z=[];for(var ab=0,ac;ab<aa.trendLineFields.length;ab++){ac=ad?"#000":n.chart.theme.dv1[ab];Z.push({type:"line",axis:"left",xField:aa.domainFields,yField:aa.trendLineFields[ab],style:{opacity:0.8,lineWidth:2,"stroke-dasharray":14,stroke:ac},markerConfig:{type:"circle",radius:0,fill:ac},title:function(){var af=C.metaData.names[aa.trendLineFields[ab]],ae=O.legendStyle;return ae&&Ext.isNumber(ae.labelMaxLength)?af.substr(0,ae.labelMaxLength)+"..":af}()})}return Z};P=function(Z){return{type:"line",axis:"left",xField:Z.domainFields,yField:Z.targetLineFields,style:{opacity:1,lineWidth:1,"stroke-width":1,stroke:"#000"},showMarkers:false,title:function(){var ab=(Ext.isString(O.targetLineTitle)?O.targetLineTitle:d.i18n.target)+" ("+O.targetLineValue+")",aa=O.legendStyle;return aa&&Ext.isNumber(aa.labelMaxLength)?ab.substr(0,aa.labelMaxLength)+"..":ab}()}};X=function(Z){return{type:"line",axis:"left",xField:Z.domainFields,yField:Z.baseLineFields,style:{opacity:1,lineWidth:1,"stroke-width":1,stroke:"#000"},showMarkers:false,title:function(){var ab=(Ext.isString(O.baseLineTitle)?O.baseLineTitle:d.i18n.base)+" ("+O.baseLineValue+")",aa=O.legendStyle;return aa&&Ext.isNumber(aa.labelMaxLength)?ab.substr(0,aa.labelMaxLength)+"..":ab}()}};B=function(){return{trackMouse:true,cls:"dv-chart-tips",renderer:function(Z,aa){if(aa.value){var ab=aa.value[1]==="0.0"?"-":aa.value[1];this.update('<div style="font-size:17px; font-weight:bold">'+q.prototype.number.prettyPrint(ab)+'</div><div style="font-size:10px">'+Z.data[n.finals.data.domain]+"</div>")}}}};N=function(aa){var Z=n.chart.theme.dv1.slice(0,aa.rangeFields.length);Ext.chart.theme.dv1=Ext.extend(Ext.chart.theme.Base,{constructor:function(ab){Ext.chart.theme.Base.prototype.constructor.call(this,Ext.apply({seriesThemes:Z,colors:Z},ab))}})};w=function(ai,af){var ae=s.dashboard?24:30,ac=s.dashboard?4:6,aj=0,al=0,aa,ah=false,ad="11px "+n.chart.style.fontFamily,ak="black";position="top",padding=0,positions=["top","right","bottom","left"],series=af.series,labelMarkerSize=O.legendStyle&&O.legendStyle.labelMarkerSize?O.legendStyle.labelMarkerSize:null,af;for(var ab=0,ag;ab<series.length;ab++){ag=series[ab].title;if(Ext.isString(ag)){aj+=1;al+=ag.length}else{if(Ext.isArray(ag)){aj+=ag.length;al+=ag.toString().split(",").join("").length}}}aa=(aj*ae)+(al*ac);if(aa>j.getCenterRegionWidth()-6){position="right"}if(Ext.isObject(O.legendStyle)){var Z=O.legendStyle;ak=Z.labelColor||ak;if(Ext.Array.contains(positions,Z.position)){position=Z.position}if(Z.labelFont){ad=Z.labelFont}else{ad=Z.labelFontWeight?Z.labelFontWeight+" ":"normal ";ad+=Z.labelFontSize?parseFloat(Z.labelFontSize)+"px ":"11px ";ad+=Z.labelFontFamily?Z.labelFontFamily:n.chart.style.fontFamily}}if(position==="right"){padding=3}af={position:position,isVertical:ah,boxStroke:"#ffffff",boxStrokeWidth:0,padding:padding,itemSpacing:3,labelFont:ad,labelColor:ak};if(labelMarkerSize){af.labelMarkerSize=labelMarkerSize}return Ext.create("Ext.chart.Legend",af)};S=function(af){var aa=[],ah="",ac,Z,ad=O.type===n.finals.chart.client.pie,ag=O.type===n.finals.chart.client.gauge;if(ad){aa.push(u[0])}else{if(ag){aa.push(u[0],y[0])}}aa=Ext.Array.clean(aa.concat(M||[]));if(Ext.isArray(aa)&&aa.length){for(var ae=0;ae<aa.length;ae++){ah+=C.metaData.names[aa[ae]];ah+=ae<aa.length-1?", ":""}}if(O.title){ah=O.title}fontSize=(j.getCenterRegionWidth()/ah.length)<11.6?12:17;ac="normal "+fontSize+"px "+n.chart.style.fontFamily;Z="black";if(Ext.isObject(O.legendStyle)){var ab=O.legendStyle;Z=ab.titleColor||Z;if(ab.titleFont){ac=ab.titleFont}else{ac=ab.titleFontWeight?ab.titleFontWeight+" ":"normal ";ac+=ab.titleFontSize?parseFloat(ab.titleFontSize)+"px ":(fontSize+"px ");ac+=ab.titleFontFamily?ab.titleFontFamily:n.chart.style.fontFamily}}return Ext.create("Ext.draw.Sprite",{type:"text",text:ah,font:ac,fill:Z,height:20,y:s.dashboard?7:20})};R=function(){return function(){var aa=j.getCenterRegionWidth(),Z=j.getCenterRegionHeight();this.animate=false;this.setWidth(s.dashboard?aa:aa-15);this.setHeight(s.dashboard?Z:Z-40);this.animate=!s.dashboard}};K=function(){return function(){if(this.items){var ae=this.items[0],af=Ext.isIE?ae.el.dom.scrollWidth:ae.el.getWidth(),ab=10,aa=this.legend,ad,Z;if(this.legend.position==="top"){ad=aa.x+(aa.width/2);Z=af?ad-(af/2):ab}else{var ac=aa?aa.width:0;Z=af?(this.width/2)-(af/2):ab}ae.setAttributes({x:Z},true)}}};J=function(ad){var af,ac=ad.store||{},ae=j.getCenterRegionWidth(),aa=j.getCenterRegionHeight(),ab=Ext.Array.contains(["LINE","AREA"],O.type),Z={animate:false,shadow:false,insetPadding:s.dashboard?17:35,insetPaddingObject:{top:s.dashboard?12:32,right:s.dashboard?(ab?5:3):(ab?25:15),bottom:s.dashboard?2:10,left:s.dashboard?(ab?15:7):(ab?70:50)},width:s.dashboard?ae:ae-15,height:s.dashboard?aa:aa-40,theme:"dv1"};if(!O.hideLegend){Z.legend=w(ac,ad);if(Z.legend.position==="right"){Z.insetPaddingObject.top=s.dashboard?22:40;Z.insetPaddingObject.right=s.dashboard?5:40}}if(O.hideTitle){Z.insetPadding=s.dashboard?1:10;Z.insetPaddingObject.top=s.dashboard?3:10}else{Z.items=[S(ac)]}Ext.apply(Z,ad);af=Ext.create("Ext.chart.Chart",Z);af.setChartSize=R();af.setTitlePosition=K();af.onViewportResize=function(){af.setChartSize();af.redraw();af.setTitlePosition()};af.on("resize",function(){af.setTitlePosition()});return af};t.column=function(ab){var Z=A(ab),ae=W(Z),ad=Y(Z),ac=[ae,ad],aa=[H(Z)];if(O.showTrendLine){aa=aa.concat(T(Z,ab))}if(O.targetLineValue){aa.push(P(Z))}if(O.baseLineValue){aa.push(X(Z))}N(Z,ab);return J({store:Z,axes:ac,series:aa})};t.stackedcolumn=function(){var aa=this.column(true);for(var Z=0,ab;Z<aa.series.items.length;Z++){ab=aa.series.items[Z];if(ab.type===n.finals.chart.client.column){ab.stacked=true}}return aa};t.bar=function(ah){var ai=A(ah),ad=W(ai),ae=Y(ai),ag,ac=H(ai),Z,aa,aj,af;ad.position="bottom";ae.position="left";ae.label.rotate.degrees=360;ag=[ad,ae];ac.type="bar";ac.axis="bottom";if(O.showValues){ac.label={display:"outside","text-anchor":"middle",field:ai.rangeFields}}ac=[ac];if(O.showTrendLine){Z=T(ai,ah);for(var ab=0;ab<Z.length;ab++){Z[ab].axis="bottom";Z[ab].xField=ai.trendLineFields[ab];Z[ab].yField=ai.domainFields}ac=ac.concat(Z)}if(O.targetLineValue){aa=P(ai);aa.axis="bottom";aa.xField=ai.targetLineFields;aa.yField=ai.domainFields;ac.push(aa)}if(O.baseLineValue){aj=X(ai);aj.axis="bottom";aj.xField=ai.baseLineFields;aj.yField=ai.domainFields;ac.push(aj)}N(ai);return J({store:ai,axes:ag,series:ac})};t.stackedbar=function(){var aa=this.bar(true);for(var Z=0,ab;Z<aa.series.items.length;Z++){ab=aa.series.items[Z];if(ab.type===n.finals.chart.client.bar){ab.stacked=true}}return aa};t.line=function(){var ag=A(),ac=W(ag),ad=Y(ag),ae=[ac,ad],aa=[],Z=n.chart.theme.dv1.slice(0,ag.rangeFields.length),af=v(ag);for(var ab=0,ah;ab<ag.rangeFields.length;ab++){ah={type:"line",axis:"left",xField:ag.domainFields,yField:ag.rangeFields[ab],style:{opacity:0.8,lineWidth:3},markerConfig:{type:"circle",radius:s.dashboard?3:4},tips:B(),title:af[ab]};aa.push(ah)}if(O.showTrendLine){aa=T(ag).concat(aa);Z=Z.concat(Z)}if(O.targetLineValue){aa.push(P(ag));Z.push("#051a2e")}if(O.baseLineValue){aa.push(X(ag));Z.push("#051a2e")}Ext.chart.theme.dv1=Ext.extend(Ext.chart.theme.Base,{constructor:function(ai){Ext.chart.theme.Base.prototype.constructor.call(this,Ext.apply({seriesThemes:Z,colors:Z},ai))}});return J({store:ag,axes:ae,series:aa})};t.area=function(){O.hideEmptyRows=true;var Z=A(true),ad=W(Z),ac=Y(Z),ab=[ad,ac],aa=H(Z);aa.type="area";aa.style.opacity=0.7;aa.style.lineWidth=0;delete aa.label;delete aa.tips;aa=[aa];if(O.showTrendLine){aa=aa.concat(T(Z,true))}if(O.targetLineValue){aa.push(P(Z))}if(O.baseLineValue){aa.push(X(Z))}N(Z);return J({store:Z,axes:ab,series:aa})};t.pie=function(){var aa=A(),ac,Z,ae,ab={field:n.finals.data.domain};if(O.showValues){var ag=n.chart.style.fontFamily,af;if(Ext.isObject(O.seriesStyle)){var ad=O.seriesStyle;af=ad.labelColor||af;if(ad.labelFont){ag=ad.labelFont}else{ag=ad.labelFontWeight?ad.labelFontWeight+" ":"normal ";ag+=ad.labelFontSize?parseFloat(ad.labelFontSize)+"px ":"11px ";ag+=ad.labelFontFamily?ad.labelFontFamily:n.chart.style.fontFamily}}ab.display="middle";ab.contrast=!af;ab.font=ag;ab.fill=af;ab.renderer=function(aj){var ah=aa.getAt(aa.findExact(n.finals.data.domain,aj)),ai=ah.data[aa.rangeFields[0]];return q.prototype.number.prettyPrint(ai)}}ac=[{type:"pie",field:aa.rangeFields[0],donut:5,showInLegend:true,highlight:{segment:{margin:5}},label:ab,style:{opacity:0.8,stroke:"#555"},tips:{trackMouse:true,cls:"dv-chart-tips",renderer:function(ah){var aj=q.prototype.number.prettyPrint(ah.data[aa.rangeFields[0]]),ai=ah.data[n.finals.data.domain];this.update('<div style="text-align:center"><div style="font-size:17px; font-weight:bold">'+aj+'</div><div style="font-size:10px">'+ai+"</div></div>")}},shadowAttributes:false,title:V(aa)}];Z=n.chart.theme.dv1.slice(0,C.nameHeaderMap[O.rowDimensionNames[0]].ids.length);Ext.chart.theme.dv1=Ext.extend(Ext.chart.theme.Base,{constructor:function(ah){Ext.chart.theme.Base.prototype.constructor.call(this,Ext.apply({seriesThemes:Z,colors:Z},ah))}});ae=J({store:aa,series:ac,insetPaddingObject:{top:s.dashboard?15:40,right:s.dashboard?2:30,bottom:s.dashboard?13:30,left:s.dashboard?7:30}});return ae};t.radar=function(){var ah=A(),ae=[],ab=[],ag=v(ah),ad="normal 9px sans-serif",ai="#333",af;ae.push({type:"Radial",position:"radial",label:{display:true}});for(var ac=0,aa;ac<ah.rangeFields.length;ac++){aa={showInLegend:true,type:"radar",xField:ah.domainFields,yField:ah.rangeFields[ac],style:{opacity:0.5},tips:B(),title:ag[ac]};if(O.showValues){aa.label={display:"over",field:ah.rangeFields[ac]}}ab.push(aa)}if(Ext.isObject(O.seriesStyle)){var Z=O.seriesStyle;ai=Z.labelColor||ai;if(Z.labelFont){ad=Z.labelFont}else{ad=Z.labelFontWeight?Z.labelFontWeight+" ":"normal ";ad+=Z.labelFontSize?parseFloat(Z.labelFontSize)+"px ":"9px ";ad+=Z.labelFontFamily?Z.labelFontFamily:n.chart.style.fontFamily}}af=J({store:ah,axes:ae,series:ab,theme:"Category2",insetPaddingObject:{top:20,right:2,bottom:15,left:7},seriesStyle:{labelColor:ai,labelFont:ad}});return af};t.gauge=function(){var af="#aaa",Z,ae,ab,ad,aa,ac;u=[u[0]];F=[F[0]];y=[y[0]];Z=A();ae={type:"gauge",position:"gauge",minimum:0,maximum:100,steps:10,margin:-7};if(x){af=m.legend.getColorByValue(x,Z.getRange()[0].data[F[0]])||af}ab={type:"gauge",field:Z.rangeFields[0],colorSet:[af,"#ddd"]};ac=J({axes:[ae],series:[ab],width:j.getCenterRegionWidth(),height:j.getCenterRegionHeight()*0.6,store:Z,insetPadding:s.dashboard?50:100,theme:null,animate:false});if(O.showValues){ac.items.push(Ext.create("Ext.draw.Sprite",{type:"text",text:Z.getRange()[0].data[F[0]],font:"normal 26px "+n.chart.style.fontFamily,fill:"#111",height:40,y:60}))}ac.setChartSize=function(){this.setWidth(j.getCenterRegionWidth());this.setHeight(j.getCenterRegionHeight()*0.6)};ac.setTitlePosition=function(){if(this.items){var al=this.items[0],ak=this.items[1],aj=10;if(al){var am=Ext.isIE?al.el.dom.scrollWidth:al.el.getWidth(),ai=am?(j.getCenterRegionWidth()/2)-(am/2):aj;al.setAttributes({x:ai},true)}if(ak){var ah=Ext.isIE?ak.el.dom.scrollWidth:ak.el.getWidth(),ag=ah?(j.getCenterRegionWidth()/2)-(ah/2):aj;ak.setAttributes({x:ag},true)}}};return ac};return t[O.type]()}}());(function(){if(Ext.isArray(r.dimensions)){q.prototype.array.sort(r.dimensions);for(var t=0,u;t<r.dimensions.length;t++){u=r.dimensions[t];u.dimensionName=u.id;u.objectName=n.finals.dimension.dimension.objectName;n.finals.dimension.objectNameMap[u.id]=u}}if(r.user&&r.user.ouc){q.prototype.array.sort(r.user.ouc)}}());p=k.message.alert;return{init:r,conf:n,api:l,support:q,service:m,web:k,app:j,webAlert:p}};d.i18n={target:"Target",base:"Base",trend:"Trend"};d.plugin={};var h={user:{}},c=[],a=false,g=false,i,b,f;i=function(j){var q=false,p=[],n=0,m="json",o,l;h.contextPath=j.url;l=function(){if(++n===p.length){g=true;for(var r=0;r<c.length;r++){f(c[r])}c=[]}};o=function(r,s){if(s.crossDomain&&Ext.isString(s.username)&&Ext.isString(s.password)){r.headers=Ext.isObject(s.headers)?s.headers:{};r.headers.Authorization="Basic "+btoa(s.username+":"+s.password)}Ext.Ajax.request(r)};p.push({url:h.contextPath+"/api/me/user-account."+m,disableCaching:false,success:function(x){h.userAccount=x.responseText?Ext.decode(x.responseText):x;var w="en",u="name",t,v,s;h.userAccount.settings.keyUiLocale=h.userAccount.settings.keyUiLocale||w;h.userAccount.settings.keyAnalysisDisplayProperty=h.userAccount.settings.keyAnalysisDisplayProperty||u;v=h.contextPath;s=h.userAccount.settings.keyUiLocale;keyAnalysisDisplayProperty=h.userAccount.settings.keyAnalysisDisplayProperty;t=keyAnalysisDisplayProperty===u?keyAnalysisDisplayProperty:keyAnalysisDisplayProperty+"|rename("+u+")";h.namePropertyUrl=t;l()}});p.push({url:h.contextPath+"/api/organisationUnits."+m+"?userOnly=true&fields=id,name,children[id,name]&paging=false",disableCaching:false,success:function(v){var u=(v.responseText?Ext.decode(v.responseText).organisationUnits:v)||[],t=[],w=[];if(u.length){for(var s=0,x;s<u.length;s++){x=u[s];t.push(x.id);if(x.children){w=Ext.Array.clean(w.concat(Ext.Array.pluck(x.children,"id")||[]))}}h.user={ou:t,ouc:w}}else{alert("User is not assigned to any organisation units")}l()}});p.push({url:h.contextPath+"/api/dimensions."+m+"?fields=id,name&paging=false",disableCaching:false,success:function(s){h.dimensions=s.responseText?Ext.decode(s.responseText).dimensions:s.dimensions;l()}});for(var k=0;k<p.length;k++){o(p[k],j)}};b=function(k){var l="",j=k.dashboard?h.contextPath+"/dhis-web-commons/javascripts/plugin/images/error_m.png":"//dhis2-cdn.org/v220/plugin/images/error_m.png";l+=".dv-chart-tips { border-radius: 2px; padding: 2px 3px 0; border: 0 none; background-color: #000; opacity: 0.9 } \n";l+=".dv-chart-tips .x-tip-body { background-color: #000; font-size: 13px; font-weight: normal; color: #fff; } \n";l+=".dv-chart-tips .x-tip-body div { text-align: center; font-family: arial,sans-serif,ubuntu,consolas !important; } \n";l+=".x-mask-msg { padding: 0; border: 0 none; background-image: none; background-color: transparent; } \n";l+=".x-mask-msg div { background-position: 11px center; } \n";l+=".x-mask-msg .x-mask-loading { border: 0 none; \n background-color: #000; color: #fff; border-radius: 2px; padding: 12px 14px 12px 30px; opacity: 0.65; } \n";l+=".x-mask { opacity: 0; } \n";l+=".ns-plugin-alert { width: 90%; padding: 5%; color: #777 } \n";l+=".x-window-body { font-size: 13px; } \n";l+=".ns-window-title-messagebox { padding-left: 16px; background-position-y: 1px; } \n";l+='.ns-window-title-messagebox.error { background-image: url("'+j+'"); } \n';Ext.util.CSS.createStyleSheet(l)};f=function(m){var p,l,k,j,o,n={core:{},app:{}};p=function(q){if(!Ext.isObject(q)){console.log("Chart configuration is not an object");return}if(!Ext.isString(q.el)){console.log("No element id provided");return}q.id=q.id||q.uid;return true};l=function(y,B){var A=y.core.init,t=y.core.api,v=y.core.conf,z=y.core.support,u=y.core.service,s=y.core.web,x="json",w={json:"application/json"},r={"Content-Type":w[x],Accepts:w[x]},q=Ext.get(m.el);A.el=m.el;y.plugin=B.plugin;y.dashboard=B.dashboard;y.crossDomain=B.crossDomain;y.skipMask=B.skipMask;y.skipFade=B.skipFade;y.el=B.el;y.username=B.username;y.password=B.password;y.ajax=z.connection.ajax;s.message=s.message||{};s.message.alert=function(C){if(q){q.setStyle("opacity",1);q.update('<div class="ns-plugin-alert">'+C+"</div>")}};s.chart=s.chart||{};s.chart.loadChart=function(E){var F,D,C={};if(!(E&&E.id)){console.log("Error, no chart id");return}F=function(H){var G=t.layout.Layout((H.responseText?Ext.decode(H.responseText):H),E);if(G){s.chart.getData(G,true)}};D=function(G){console.log(E.id,(G.responseText?Ext.decode(G.responseText):G))};C.url=A.contextPath+"/api/charts/"+E.id+"."+x+"?fields="+v.url.analysisFields.join(",");C.disableCaching=false;C.headers=r;C.success=F;C.failure=D;y.ajax(C,y)};s.chart.getData=function(F,G){var D,H,C,E;if(!F){return}E=function(I){if(!y.skipMask){s.mask.hide(y.app.centerRegion)}};D=u.layout.getExtendedLayout(F);H=s.analytics.getParamString(D)+"&skipData=true";C=s.analytics.getParamString(D,true)+"&skipMeta=true";if(!y.skipMask){s.mask.show(y.app.centerRegion)}y.ajax({url:A.contextPath+"/api/analytics.json"+H,timeout:60000,headers:{"Content-Type":"application/json",Accepts:"application/json"},disableCaching:false,failure:function(I){E(I)},success:function(J){var I=Ext.decode(J.responseText).metaData;y.ajax({url:A.contextPath+"/api/analytics.json"+C,timeout:60000,headers:{"Content-Type":"application/json",Accepts:"application/json"},disableCaching:false,failure:function(K){E(K)},success:function(L){var K=t.response.Response(Ext.decode(L.responseText));if(!K){E();return}K.metaData=I;D=u.layout.getSyncronizedXLayout(D,K);if(!D){return}y.app.paramString=C;s.chart.getChart(F,D,K,G)}},y)}},y)};s.chart.getChart=function(I,K,H,D){var O,C,E,G,F=y.core.conf.finals.dimension.indicator.objectName,L,N,M,J;M=function(){y.app.layout=I;y.app.xLayout=K;y.app.response=H;y.app.xResponse=O;y.app.chart=J;if(!y.skipMask){s.mask.hide(y.app.centerRegion)}if(d.isDebug){console.log("layout",y.app.layout);console.log("xLayout",y.app.xLayout);console.log("response",y.app.response);console.log("xResponse",y.app.xResponse)}};N=function(){J=y.core.web.chart.createChart(K,O,L);y.app.centerRegion.removeAll();y.app.centerRegion.add(J);M()};if(!H.rows.length){y.app.centerRegion.removeAll(true);y.app.centerRegion.update("");y.app.centerRegion.add({bodyStyle:"padding:20px; border:0 none; background:transparent; color: #555; font-size:11px",html:"No values found for the current selection."});M()}else{if(!K){K=u.layout.getExtendedLayout(I)}O=u.response.getExtendedResponse(K,H);if(K.type==="GAUGE"&&Ext.Array.contains(K.axisObjectNames,F)&&K.objectNameIdsMap[F].length){Ext.Ajax.request({url:y.core.init.contextPath+"/api/indicators/"+K.objectNameIdsMap[F][0]+".json?fields=legendSet[legends[id,name,startValue,endValue,color]]",disableCaching:false,success:function(P){L=Ext.decode(P.responseText).legendSet},callback:function(){N()}})}else{N()}}}};k=function(){var t=Ext.get(n.core.init.el),w,r,s,y;if(!n.skipFade&&t){var x=parseInt(t.getStyle("border-left-width"))+parseInt(t.getStyle("border-right-width")),u=parseInt(t.getStyle("border-top-width"))+parseInt(t.getStyle("border-bottom-width")),v=parseInt(t.getStyle("padding-left"))+parseInt(t.getStyle("padding-right")),q=parseInt(t.getStyle("padding-top"))+parseInt(t.getStyle("padding-bottom"));s=t.getWidth()-x-v,y=t.getHeight()-u-q}r=Ext.create("Ext.panel.Panel",{renderTo:t,bodyStyle:"border: 0 none",width:m.width||s||"100%",height:m.height||y||"50%",layout:"fit"});return{getWidth:function(){return t.getWidth()},getHeight:function(){return t.getHeight()},centerRegion:r}};j=function(){var q=Ext.get(m.el);if(!p(m)){return}appConfig={plugin:true,dashboard:Ext.isBoolean(m.dashboard)?m.dashboard:false,crossDomain:Ext.isBoolean(m.crossDomain)?m.crossDomain:true,skipMask:Ext.isBoolean(m.skipMask)?m.skipMask:false,skipFade:Ext.isBoolean(m.skipFade)?m.skipFade:false,el:Ext.isString(m.el)?m.el:null,username:Ext.isString(m.username)?m.username:null,password:Ext.isString(m.password)?m.password:null};b(m);n.core=d.getCore(h,appConfig);l(n,appConfig);n.app.viewport=k();n.app.centerRegion=n.app.viewport.centerRegion;n.core.app.getViewportWidth=function(){return n.app.viewport.getWidth()};n.core.app.getViewportHeight=function(){return n.app.viewport.getHeight()};n.core.app.getCenterRegionWidth=function(){return n.app.viewport.centerRegion.getWidth()};n.core.app.getCenterRegionHeight=function(){return n.app.viewport.centerRegion.getHeight()};d.instances.push(n);if(q){q.setViewportWidth=function(r){n.app.centerRegion.setWidth(r)}}if(m&&m.id){n.core.web.chart.loadChart(m)}else{layout=n.core.api.layout.Layout(m);if(!layout){return}n.core.web.chart.getData(layout)}}()};d.plugin.getChart=function(j){if(Ext.isString(j.url)&&j.url.split("").pop()==="/"){j.url=j.url.substr(0,j.url.length-1)}if(g){f(j)}else{c.push(j);if(!a){a=true;i(j)}}};DHIS=Ext.isObject(window.DHIS)?DHIS:{};DHIS.getChart=d.plugin.getChart});